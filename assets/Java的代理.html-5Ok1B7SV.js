import{_ as e,r as c,o,c as l,b as n,e as p,w as t,d as s,a as i}from"./app-7rGY8hGP.js";const u="/life-doc/assets/67ed566dfa971de521b11061a9bd39e1-zE1AToGz.png",k="/life-doc/assets/57e70df6946e086793161cd659b730d3-jRWjqEp-.png",d="/life-doc/assets/dc895708a63d19aefdcb3f21ee4210ba-7q3QHAiJ.png",r="/life-doc/assets/059ce5502414e218d81900beecc7d932-dx1UBxGD.png",v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANEAAACBCAIAAADR1shPAAAMoElEQVR4Ae2d72scxxnH712R/hq/qF8Iit44feN3LU5cvylEkCtqCw0hlRCJXctxardIss+2qphgSBV0GBdKYtDlilWn1Y+UpJbiVrtgnUJD2rrkXAmOIJm6VrxhZnaenZldnXZXc/vc7j3iQLOzs7Mz3/kwz8zOPLslj/5IgWwVKGV7O7obKeARcwRB1gpYYO73f/gT/Op//svn//pP1pWg++VKAcvMCfge/OOLtCLUyiXxV66lzYKu63IFNOZardbOzo5R4p2dnVarZUSqh9DJHRhQr4oKN6YGfNQYekRdlEYFiNOYm5ubm56eVrHb2dmZnp6em5trU9UDUYMEbTIxT9XKpYGphhlLx0VQQGNOEAbYGYf7VReQev/O4pqzseZsvH9nESLVgJJDY2oggEo74IkIOUWrogU15jzPA86azeY0/1O7vcjaA1UPm/8VCR5++Qgi1YB2eYAVQ843pCzI/siualoV68BkDrA7e/YsdHjtqwxUPd3bEymf7u1BpBrQ85HQKchBAjaeI9sKchQrEMGcwO7WrVsH9nBCCqDq4ZePREysfs7zBHSNqYEouiSRxZKbauN5Np4JA3Pv3VlcdR6sOg/eO3g8x8VnuJXLgFwwbfXCIzxqrcIoEN3PJaoeMHdgIJQtH74pYzc5nKMRXUiqAkXgMlcgIakqsRWwwFzse1FCUoApQMwRB1krQMxlrTjdj5gjBrJWgJjLWnG6HzFHDGStADGXteJ0P2KOGMhaAXzmHu89W27uzm62Ku52xd2e3WwtN3cf7z3LWgm6X1YKIDO30Xpyxd2eWN8yflfc7Y3Wk6xEoPtkqgAmcxutJ5OOSRvAN+ls7Y9do3Kp1FdN4TLBLuwf9X/DTqZa082EAmjM7T79OrKHA+Ym1reuuNu7T7+OaKrm1OClgcGRcj3iXPuoRuXSQKXJ0zSnBkdkuP1FdNaqAmjMLTd3Aa9f/635o6vvHh/66XMnf/jCz8fHP3Th1HJzN1zfzYWBwYVGvVpK3lEpzHlevVoaXCCni7DAnY1BY252swVgvVT57anXLp7/6LOLq/9+9Xd3f/nxF3BqdjPscia5ccp9l6Y2fX1qwyMDlYWysJucJGZGA6R44oYnr+VXSeZYymGnNjxSkhmysMiqT/ammwsDEK5XS9+aezucvyxMZ9ss77mjMaca1uNDPzm/8hlwpgauuNumxAFqnDNhKD1OjBjhgdEMUrIujXeKCnOQjIFYAp48npUGq8TOZxSyhQDvMpN3umbNeuS4e5jbVFGDcJg52TmxBlLCKn8AFkTWhn1ugjlEXzCYE/2cbHGFJB6lnuVkBxeG85eZ0P/9FUBjTret7/xg7M3zK5sXPvnny+/Ov177KzAXsq2B1dNtHzS/5ykGVIz8mFn0J7mAoyqJSpXnRTAHUw2DOS+Uv5othaMVQGPOmEO8VHnn+Is//u6pF0+9duGN5QYwZ84hnLJiBD1hB7lRi2bOYzPc8jDMVRUcFT105sK2VY4aRbfKCJYxofyVXCm4jwJozKV7VlKvmo/lZMw+zHH7GyASizkfZb0fZXZc5sMYlR2nGr+PxhStK4DGnOd5h3gmrFei7ZEy5mubLu3JTueftlzdex0mcwI7dQILJtXa2hebnKZ4dBy7wTqdf+yC5CghMnOe53Vujb9eZc/YOvcIo9P55wijREXFZy5RcSlxARQg5grQiDmrAjGXswYrQHGJuQI0Ys6qQMzlrMEKUFxirgCNmLMq4DPXuWclOWuKnikuMnMW/CGCLUk902g5rygmc6nWvoz1eI+tsgebi3LeGr1RfDTm0q3x831KHVxa6I1GR64lGnPGXqbY/hChfg5ZQLp9YgXQmNP3bMb3hwgxp62yazs6/a1HagI1zPfJGRuWZD/K92bCJrnEqtIF7RRAY07dTpLEH6INcwwUWNEPtrupnAVhljjK6YHlr28LbScfnUuhQPcwF9MfYn/mjD3lcBhwJiYcfGsTnPU1g2whkEJMuiSWAmjM6bY1vj9EiAlAysAIDiGB15454fQQyj+WjJQogQJozBlziLj+ENwvEAwoq2iAlGpbGTrKeM53olF8VEO21R+9EXMJ6EmXFI25wzwrEQP//lFGVSNgjrlsyTkB86+W7gvMO0vED1bLyrZhhp1MD3uJibl0ICW4Co25jvtDgG1NoAYlzUIBTOY66w9BzGXBT5p7IDPXQX8IYi4ND1lcg89cFrWke3STAsRcN7VGb5SFmOuNdu6mWhJz3dQavVEWYq432rmbatmlzL219sbu/7/qJqGoLNYUwGcu0h9iaP7YK3984e+PPrZWUcqoaxRAZm4/f4ih+WPiN7t++X97jy3IxZbI4NWFFvKjLFIrgMlcG38IYG5o/tiFj36mVI8v3kfQwxZPYYFVSS+DxJxUAv0/GnPt1/iBud+svakP7Bhz7OMQ+jv2xSp+O+bQlaYCSAXQmDP2Mhn+EEPzx8r17//ikw/Md7uKvUwLxlvl+FuClY0ksnb0vxsVQGNO37Np+kO8/OHrv7r/+cT6Vugd1v5eI+3tlmJpVV1gZZZU/8BSsOWJvwVW+5JENzZMgcuExtxh/SGCl1nLHW8Bc41KVX6rBJJpzMm3AdMgDwPt7mEuqT8EH9gtNIJX6wfMMSFhn6bvUKMxBxPYyFf3Y7RDL90TjTndtqbyh+CQVeCbXcAcw0v6dAFqEGAuhsQcJuNozBlziFT+EPz5CLyiGpiDAO/tqJ/D5Cvq3mjMtX9WIl6gHvUtTTl645VRPnCjfr+GpTEdIKifi2p+lDg05jruD4EiJ900hgKYzHXWHyJG5SkJigLIzHXQHwJFTrppDAXwmYtRSEpSKAWIuUI1Zy4qQ8zlopkKVUhirlDNmYvKEHO5aKZCFZKYK1Rz5qIy+MxF+kM83nuWC/mokCkUQGZuP38Ia98MTiEJXdJhBTCZa+MPMbG+NelsbbSehKofrKV29HvAoftShDUF0Jg7xBq/3InElu1l2JogkJG2mQBiKXB4BdCYM/YyGf4QYl/JxPpWlD9EwJm2Q/3wYmg5EHOaHBYP0JjT92ya/hDAXJQ/RCRzwYtaA5cw1hHqXhFiw6bhDBFsc/LfTvyB+ukI+kqERdx4VmjMHcIfQjIX2FZj66/4SkSUVwSHqa9aY3WHy0PM1dlp6udssybz6x7mEvhDyBdPS/jkq6tFfP+o3Jge9oqI3JhOzEkasvmPxpxuWxP5Q0jUQCFlMzrE8W5MwhdQZfSIPKvgrPrmf+rnAi3thtCYM+YQSfwhQsxxiwkfjahXzS/d6J+FgMul0xdjzo9UUhJzdkkLckNjzsKzkqAWon8ypgsMGtMrItK2KiZY/YAEvY9CFdhiGI058oew2Ir5ygqTOfKHyBcrtkqLzBz5Q9hqyBzlg89cjsSiolpRgJizIiNlkkABYi6BWJTUigIll/5IgWwVIOay1Zvu5rrEHFGQtQL4zN131m7fu3ljZfLq0vjVpfEbK5O3792876xlrQTdLysFkJm7u1a/tnTu8uJp43dt6dzdtXpHRXBqJ/oujtQcp6N3oczDCmAyd3etXlk6Y9AGh5WlM2HsHGd+7KK/ito/WjpZS08MMRemIZsYNOY+XV+N7OGAucuLp68tnft0fVUVgjN3ZGyZoeYsjxwd8cNqmpjhpMwJ3A9DecyCFT4ZGnO3791U8Xrue9+Bnxp/+95NtQ1U5lzXvT5TOlqdVxPEDxNz8bWymxKNuRsrkypblxdPD515fujM80bkjZVJtcKRzMkeaObkSEkM0RyHheV24hPX5aBNje8flYlZf+mn4X2nDCuZfHtuPMiQRoFqkyQPozEXNqyRzF1bOqdWSmUObKtgrg+44axA/8f6M35KAAfG8fpMO+ZEYsiEmXI+lITL1VJROJECeWQOOjA5sNNpMIwmsGLGy3mr1rfJPs9ITMwloqp9YjTmrNhWUTegyj+UMClnGZ0GRnBIzLVHxPpZNOaszCEUqoLnJoZZDNjiNlcYR98c85EZ2GjXdWvVI2FD7DgzY9V5g2zrLdE7GaIxd/hnJdBIYRrUuQKM85h9rJ2QE4sjY9XgmXCtekTEH505oc8nmB2HHEQyepIMyqcLoDHnum6KZ8LpKklXdZUCmMwJ7MITWPE0OLwI0VXCUWFSK4DMnOu6tMafuvFyeiE+czkVjoqdWgFiLrV0dGFKBYi5lMLRZakVIB8cK24llEkCBYi5BGJRUisKEHNWZKRMEihgkzn60kMC4Xs4qU3melhGqnoCBYi5BGJRUisKEHNWZKRMEihAzCUQi5JaUYCYsyIjZZJAAWIugViU1IoC3wBz7ryAN5BvdAAAAABJRU5ErkJggg==",m="/life-doc/assets/5854e50c23964fcebfe56d129a9bfb33-wSmZQqFK.png",b="/life-doc/assets/04a12cefa429420fb1bf3e729c723435-XqcNLQoi.png",y="/life-doc/assets/f2c35ae39f0245b4666c06e325557b77-hoF-dPZX.png",w={},h=n("h1",{id:"java的代理",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#java的代理","aria-hidden":"true"},"#"),s(" Java的代理")],-1),g={class:"table-of-contents"},f=i('<p>Java的代理有2中，JDK动态代理和CGLIB代理</p><p>代理：代而理之</p><h2 id="一、jdk动态代理" tabindex="-1"><a class="header-anchor" href="#一、jdk动态代理" aria-hidden="true">#</a> 一、JDK动态代理</h2><p>Java自带</p><h3 id="_1-1静态代理" tabindex="-1"><a class="header-anchor" href="#_1-1静态代理" aria-hidden="true">#</a> 1.1静态代理</h3><h4 id="代理一个" tabindex="-1"><a class="header-anchor" href="#代理一个" aria-hidden="true">#</a> 代理一个</h4><p>我要买酒，现在肯定不是去酒厂直接买酒，我们要去酒厂的分销商（也就是酒厂的代理）去买，我们得到的也是酒，但我们还能在这个分销商这看到别的跟酒厂不一样的东西，比如，代理商给酒包的酒做了装饰更好看了价格更贵了，等。然后才面向我们销售产品，这个代理商做的事情就是代理。</p><h5 id="类关系" tabindex="-1"><a class="header-anchor" href="#类关系" aria-hidden="true">#</a> 类关系</h5><p><img src="'+u+'" alt=""></p><p>图中显示很明显我们的类和接口加起来需要4个</p><p><img src="'+k+`" alt=""></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 抽象类
 * <span class="token keyword">@author</span> WangWenLei
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 生产酒
     */</span>
    <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 酒厂
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Liquor</span> <span class="token keyword">implements</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;我们生产了酒。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 酒厂代理
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LiquorProxy</span> <span class="token keyword">implements</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token class-name">Liquor</span> liquor<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">LiquorProxy</span><span class="token punctuation">(</span><span class="token class-name">Liquor</span> liquor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>liquor <span class="token operator">=</span> liquor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;给我一部分定金，我去跟厂家沟通买回来。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        liquor<span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;酒回来了，你来取吧~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 调用者
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">LiquorProxy</span> liquorProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LiquorProxy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Liquor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        liquorProxy<span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="实现效果" tabindex="-1"><a class="header-anchor" href="#实现效果" aria-hidden="true">#</a> 实现效果</h5><p><img src="`+d+`" alt=""></p><h4 id="代理多个" tabindex="-1"><a class="header-anchor" href="#代理多个" aria-hidden="true">#</a> 代理多个</h4><p>我在买酒时既不想去找酒厂沟通，还想知道我买到酒花费了多长时间，你得告我去取酒，你还得告诉我造酒花费了多长时间。</p><p>这里如果单独统计多长时间我们可以向上一节一样把他使用一个单独的代理来实现。但是面对现在的需求上节方法可行性差，要2个或多个任务一起，一个一个搞太复杂不好实现。</p><p>上节我们是把Liquor传入我们的代理类，现在我们既想代理卖酒又想统计时间，这里就不能是固定的Liquor，需要是他的抽象类对象，这样我们才能把同样是实现抽象类的类传进来，进行逐层的反复的使用。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 抽象类
 * <span class="token keyword">@author</span> WangWenLei
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 生产酒
     */</span>
    <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 酒厂
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Liquor</span> <span class="token keyword">implements</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;我们生产了酒。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 线程休息5秒钟</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 酒厂代理
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LiquorProxy</span> <span class="token keyword">implements</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token class-name">Product</span> product<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">LiquorProxy</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>product <span class="token operator">=</span> product<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;给我一部分定金，我去跟厂家沟通买回来。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;酒回来了，你来取吧~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 生产需要花费的时间
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductTimeProxy</span> <span class="token keyword">implements</span> <span class="token class-name">Product</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">ProductTimeProxy</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>product <span class="token operator">=</span> product<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Product</span> product<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//开始时间</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;生产时花费了&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ms时间！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 调用者：代理酒厂还要统计花费多长时间
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 先沟通买酒后统计总时间</span>
        <span class="token class-name">Product</span> product1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProductTimeProxy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LiquorProxy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Liquor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product1<span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------------------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 先统计造酒花费时间再沟通买酒</span>
        <span class="token class-name">Product</span> product2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LiquorProxy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProductTimeProxy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Liquor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product2<span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="实现效果-1" tabindex="-1"><a class="header-anchor" href="#实现效果-1" aria-hidden="true">#</a> 实现效果</h5><p><img src="`+r+'" alt=""></p><h3 id="_1-2jdk动态代理" tabindex="-1"><a class="header-anchor" href="#_1-2jdk动态代理" aria-hidden="true">#</a> 1.2JDK动态代理</h3><p>我买了酒还不满足，我想在买酒的地方买花生米，这就需要代理商不止代理的酒厂，还要代理花生米厂</p><p>静态代理是固定的一个类，现在需要不同的类，所以此时的类就不是固定的需要动态生成，故叫动态代理</p><h4 id="先来用一下" tabindex="-1"><a class="header-anchor" href="#先来用一下" aria-hidden="true">#</a> 先来用一下</h4><p>代理类实现<code>InvocationHandler</code>接口，重写<code>public Object invoke(Object proxy, Method method, Object[] args) throws Throwable{}</code>方法</p><p><img src="'+v+`" alt=""></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 抽象类
 * <span class="token keyword">@author</span> WangWenLei
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 生产酒
     */</span>
    <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 酒厂
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Liquor</span> <span class="token keyword">implements</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;我们生产了酒。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 花生米工厂
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Peanut</span> <span class="token keyword">implements</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;我这里生产了花生米！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 代理商
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AnyProxy</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> object<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">AnyProxy</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>object <span class="token operator">=</span> object<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;代理开始。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> invoke <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;代理结束。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> invoke<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 调用者
 * <span class="token keyword">@author</span> WangWenLei
 * @DATE: 2021/4/7
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 酒</span>
        <span class="token class-name">Product</span> liquor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Liquor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 花生米</span>
        <span class="token class-name">Product</span> peanut <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Peanut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 代理酒做什么事情</span>
        <span class="token class-name">AnyProxy</span> handler1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnyProxy</span><span class="token punctuation">(</span>liquor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 代理花生米做什么事情</span>
        <span class="token class-name">AnyProxy</span> handler2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnyProxy</span><span class="token punctuation">(</span>peanut<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 建立与酒的代理关系</span>
        <span class="token class-name">Product</span> product1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Product</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>liquor<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> liquor<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>handler1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 建立与花生米的代理关系</span>
        <span class="token class-name">Product</span> product2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Product</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>peanut<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> peanut<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>handler2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 调用代理方法</span>
        product1<span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product2<span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现效果-2" tabindex="-1"><a class="header-anchor" href="#实现效果-2" aria-hidden="true">#</a> 实现效果</h4><p><img src="`+m+`" alt=""></p><h3 id="_1-3理解jdk动态代理" tabindex="-1"><a class="header-anchor" href="#_1-3理解jdk动态代理" aria-hidden="true">#</a> 1.3理解JDK动态代理</h3><p>背后动作需要理解下，发现我们是没有调用invoke方法的，但实际打印出的效果是调用了这个方法，所以他肯定是在背后产生了一个逻辑让程序隐性调用了这个方法。</p><h4 id="首先我们看他生成代理类的内容" tabindex="-1"><a class="header-anchor" href="#首先我们看他生成代理类的内容" aria-hidden="true">#</a> 首先我们看他生成代理类的内容</h4><p>在main方法的第一句加上下面的代码，让产生保存生成代理类的代码</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 设置固化生成的代理文件</span>
<span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">&quot;sun.misc.ProxyGenerator.saveGeneratedFiles&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>运行程序后会发现在我们的根目录，出现了com的文件夹</p><p><img src="`+b+`" alt=""></p><h4 id="分析代理类代码" tabindex="-1"><a class="header-anchor" href="#分析代理类代码" aria-hidden="true">#</a> 分析代理类代码</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//</span>
<span class="token comment">// Source code recreated from a .class file by IntelliJ IDEA</span>
<span class="token comment">// (powered by FernFlower decompiler)</span>
<span class="token comment">// 说：资源代码是由IDEA通过FernFlower反编译提供创建的.class文件</span>
<span class="token comment">//</span>

<span class="token comment">// 代理类生成包名</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>proxy</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>wenwen<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>service<span class="token punctuation">.</span>learn<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>v3<span class="token punctuation">.</span></span><span class="token class-name">Product</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">InvocationHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Proxy</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">UndeclaredThrowableException</span></span><span class="token punctuation">;</span>

<span class="token comment">// 代理类名 ： $Proxy0</span>
<span class="token comment">// 继承 Proxy</span>
<span class="token comment">// 实现 Product —— Product是我们自己的抽象类</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> $<span class="token class-name">Proxy0</span> <span class="token keyword">extends</span> <span class="token class-name">Proxy</span> <span class="token keyword">implements</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m1<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m2<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m3<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m0<span class="token punctuation">;</span>

    <span class="token comment">// *【0】发现 InvocationHandler 类型的 var1 虚参构成的构造方法：我们的代理商实现了InvocationHandler类，由newProxyInstance的</span>
    <span class="token comment">// 的第4个参数传入</span>
    <span class="token keyword">public</span> $<span class="token class-name">Proxy0</span><span class="token punctuation">(</span><span class="token class-name">InvocationHandler</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 每个类都有的equals，这个是通用用的，不用太关注</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m1<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>var1<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> var3<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var4<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 每个类都有的toString，这个是通用用的，不用太关注</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> var2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// *【1】这个很重要</span>
    <span class="token comment">// 发现没有，这个方法才是我们main中实际调用的方法</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 方法里调用了父类里的h参数的invoke方法</span>
                <span class="token comment">// 这个类的父类是Proxy，Proxy的h是怎么来的：看上面本类的构造方法【0】的位置，那里调用的父类的构造方法，</span>
                <span class="token comment">// 并传入InvocationHandler 类型的 var1。</span>
                <span class="token comment">// 看下Proxy的构造方法:</span>
                <span class="token comment">// protected InvocationHandler h;</span>
                <span class="token comment">// protected Proxy(InvocationHandler h) {</span>
                <span class="token comment">//     Objects.requireNonNull(h);</span>
                <span class="token comment">//     this.h = h;</span>
                <span class="token comment">// }</span>
            <span class="token comment">// invoke方法，这里的这个方法就是我们写的AnyProxy里的invoke方法，传了3个参数</span>
                <span class="token comment">// 1. this : main方法中newProxyInstance出来的当前类对象</span>
                <span class="token comment">// 2. m3 :  Class.forName(&quot;com.wenwen.blog.service.learn.proxy.v3.Product&quot;).getMethod(&quot;product&quot;);</span>
            	<span class="token comment">// 		实际要执行的代理方法，我们的酒厂或者花生米厂里方法名</span>
                <span class="token comment">// 3. (Object[])null 传递的参数</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m3<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> var2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 每个类都有的hashCode，这个是通用用的，不用太关注</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m0<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> var2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            m1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.Object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;equals&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.Object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            m2 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.Object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;toString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            m3 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;com.wenwen.blog.service.learn.proxy.v3.Product&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;product&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            m0 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.Object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;hashCode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchMethodException</span> var2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchMethodError</span><span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> var3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoClassDefFoundError</span><span class="token punctuation">(</span>var3<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-4总结下" tabindex="-1"><a class="header-anchor" href="#_1-4总结下" aria-hidden="true">#</a> 1.4总结下</h3><p>让我们用时序图整理下思路</p><p><img src="`+y+'" alt=""></p><p>整理下来发现：动态代理跟静态代理最终的原理一样。都是抽象类的两个聚合类，一个是代理，一个是实现。代理里调用了实现里面的方法。只是动态代理的代理类是动态生成的，可进行类的切换，切换后有Java进行生成代理类。</p><h2 id="二、-cglib动态代理" tabindex="-1"><a class="header-anchor" href="#二、-cglib动态代理" aria-hidden="true">#</a> 二、 CGLIB动态代理</h2><hr><p>#代理</p>',46);function q(x,P){const a=c("router-link");return o(),l("div",null,[h,n("nav",g,[n("ul",null,[n("li",null,[p(a,{to:"#一、jdk动态代理"},{default:t(()=>[s("一、JDK动态代理")]),_:1}),n("ul",null,[n("li",null,[p(a,{to:"#_1-1静态代理"},{default:t(()=>[s("1.1静态代理")]),_:1})]),n("li",null,[p(a,{to:"#_1-2jdk动态代理"},{default:t(()=>[s("1.2JDK动态代理")]),_:1})]),n("li",null,[p(a,{to:"#_1-3理解jdk动态代理"},{default:t(()=>[s("1.3理解JDK动态代理")]),_:1})]),n("li",null,[p(a,{to:"#_1-4总结下"},{default:t(()=>[s("1.4总结下")]),_:1})])])]),n("li",null,[p(a,{to:"#二、-cglib动态代理"},{default:t(()=>[s("二、 CGLIB动态代理")]),_:1})])])]),f])}const E=e(w,[["render",q],["__file","Java的代理.html.vue"]]);export{E as default};
